# ネットワークプロトコル（Network Protocol）

- ネットワークを通じてコンピュータ同士が情報をやりとりする手順
- 通信を行う手順を定めたものであると同時に、コンピュータ同士が会話するために必要な共通言語でもある
- ネットワークプロトコルは、階層構造で区分けされている
- 使用するネットワークサービスごとに、それぞれ最適なプロトコルを組み合わせて用いることができる

# OSI参照モデル（OSI階層モデル）

- ネットワークの基本構造を7つの階層に分けて管理する階層構造のこと
- 階層構造に分けることで以下のメリットがある
    - 相互運用性：異なる機種同士でも問題なくデータを送受信できる
    - 機能の拡張性：ネットワーク機能の拡張やサービスの追加

## 第１層：物理層

- 物理的なもの（ケーブルやピンの数、電気特性）を定め、送出データの電気的な変換などを行う

## 第２層：データリンク層

- 直結された相手との通信路を確保し、データの誤り訂正や再送要求などを行う

## 第３層：ネットワーク層

- 相手までデータを届けるための経路選択やネットワーク上でここを識別するためのアドレス管理などを行う
- **IPアドレス**の概念はこの層に位置づけられる

## 第４層：トランスポート層

- ネットワーク層から流れてきたデータの整列や誤り訂正などを行い、送受信されたデータの信頼性を確保する
- **TCP**や**UDP**といったプロトコルはこの層に位置づけられる

## 第５層：セッション層

- 通信の開始や終了といった通信プログラム同士の接続を管理し、通信経路の確立を行う

## 第６層：プレゼンテーション層

- 圧縮方式や文字コードなどを管理し、アプリケーションソフトとネットワークとの仲介を行う

## 第７層：アプリケーション層

- 通信を利用するために必要なサービスが、人間や他のプログラムに対して提供される

# TCP/IP

## IP（Internet Protocol）

- OSI参照モデルにおける第３層のネットワーク層に位置づけられるネットワークプロトコル
- ネットワーク上の機器に対するアドレス割り当てや、そのアドレスをもとにパケットを伝送する役割を持つ
- IPは、パケット（送信データ）をTCPやUDPから受け取ると、**IPヘッダ**を付与し、ネットワークへ送り出す
    - IPヘッダ：送信元と送信先のIPアドレスを中心とした情報の集まり
- 経路を選択する方法についても定義されている
    - 複数のネットワークをまたいだ通信もできる
    - ルータがIPの経路選択（ルーティング）をサポートしており、ルータから宛先の属するネットワークのルータへとパケットが送出されていくことで、目的地へたどり着けるようになっている

## TCP（Transmission Control Protocol）

- OSI参照モデルにおける第４層のトランスポート層に位置づけられるネットワークプロトコル
- 第５層（セッション層）以上のプロトコルから通信データを受け取り、パケットに分割する
- そのパケットを第３層（ネットワーク層）のIPへ渡し、相手に送り届ける
- パケットの欠損に対する保証がないIPの上位層として、信頼性の髙いデータ通信を保証する
    - IPでは、パケットの配送時にパケットの欠損や遅延による順序の入れ替わりなどが発生する
    - 通信パケットへ分割する際に、分割順に割り振ったシーケンス番号を付加する
    - 受信側では、この番号をチェックし、必要であれば並び替えを行う
    - 受信側からはACKパケット（受信したことを示す通知パケット）を送信側へ送り返す
    - 一定時間返事がない場合にはパケットを再送出する
